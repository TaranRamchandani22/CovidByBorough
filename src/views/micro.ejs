<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Micrographics</title>
  <meta name="author" content="Taran and Amelia">
  <meta name="description" content="Infographics">
  <!-- <link rel = "stylesheet" href = "../css/styles.css"> -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js" integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js" integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous"></script>
  <script src="https://d3js.org/d3.v5.min.js"></script>
  <!-- <script src="https://d3js.org/d3.v5.min.js"></script> -->

  <script src='https://cdn.plot.ly/plotly-2.6.3.min.js'></script>
  <script src='https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.17/d3.min.js'></script>
  <style>
    .bar {
      fill: steelblue;
    }

    .bar:hover {
      fill: brown;
    }

    .axis--x path {
      display: none;
    }
  </style>
</head>

<body>
  <%- include('../src/views/partials/navbar.ejs') -%>
  <div id='myDiv'><!-- Plotly chart will be drawn inside this DIV --></div>

        <table>
          <tr>
            <th>zip</th>
            <th>caseRate</th>
            <th>vacinationRate</th>
            <th>allHouseholdIncome</th>
            <th>percentLatino</th>
            <th>percentAsianNonHispanic</th>
            <th>percentWhiteNonHispanic</th>
            <th>percentOtherEthnicity</th>
            <th>percentEthnicityUnkown</th>
            <th>blackNonHispanic</th>
          </tr>
          <tr>
            <td><%= totalMicroData.zip %></td>
            <td><%= totalMicroData.caseRate %></td>
            <td><%= totalMicroData.vacinationRate %></td>
            <td><%= totalMicroData.allHouseholdIncome %></td>
            <td><%= totalMicroData.percentLatino %></td>
            <td><%= totalMicroData.percentAsianNonHispanic %></td>
            <td><%= totalMicroData.percentWhiteNonHispanic %></td>
            <td><%= totalMicroData.percentOtherEthnicity %></td>
            <td><%= totalMicroData.percentEthnicityUnkown %></td>
            <td><%= totalMicroData.blackNonHispanic %></td>
          </tr>
      </table>

  <script>
  let percentL= <%= totalMicroData.percentLatino %>;
  let percentAsian= <%= totalMicroData.percentAsianNonHispanic %>;
  let percentWhite= <%= totalMicroData.percentWhiteNonHispanic %>;
  let percentOther= <%= totalMicroData.percentOtherEthnicity %>;
  let percentUnknown= <%= totalMicroData.percentEthnicityUnkown %>;
  let percentBlack=  <%= totalMicroData.blackNonHispanic %>;
    var data = [{
      values: [percentL, percentAsian, percentWhite,percentOther,percentUnknown,percentBlack],
      labels: ['percentL', 'Non-percentAsian', 'percentWhite','percentOther','percentUnknown','percentBlack'],
      type: 'pie'
    }];
    var layout = {
      title: 'Breakdown of Zipcode Based on Race',
      height: 400,
      width: 500
    };
    Plotly.newPlot('myDiv', data, layout);
  </script>

  <tr>
    Zipcode Number:
    <td><%= data %></td>
  </tr>

  <section id="summary">
      <h1>Summary:</h1>
      <ul>
          <p> The pie charts above display that zip code <%= totalMicroData.zip %>'s average vacination rate is <%= totalMicroData.vacinationRate %> .</p>
          <li> Zipcode <%= totalMicroData.zip %> has a case rate of <%= totalMicroData.caseRate %> . </li>
      </ul>
    </section>

    <%- include('../src/views/partials/footer.ejs') -%>

</body>

</html>
